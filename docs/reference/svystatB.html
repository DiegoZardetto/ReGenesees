<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimation of Population Regression Coefficients — svystatB • ReGenesees</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimation of Population Regression Coefficients — svystatB" />
<meta property="og:description" content="Computes estimates, standard errors and confidence intervals for Multiple Regression Coefficients." />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ReGenesees</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Calibration_Efficiency_MC.html">On the Efficiency Gain of Calibration Estimators</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimation of Population Regression Coefficients</h1>
    
    <div class="hidden name"><code>svystatB.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes estimates, standard errors and confidence intervals for Multiple Regression Coefficients.</p>
    </div>

    <pre class="usage"><span class='fu'>svystatB</span>(<span class='no'>design</span>, <span class='no'>model</span>,
         <span class='kw'>vartype</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"se"</span>, <span class='st'>"cv"</span>, <span class='st'>"cvpct"</span>, <span class='st'>"var"</span>),
         <span class='kw'>conf.int</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>conf.lev</span> <span class='kw'>=</span> <span class='fl'>0.95</span>, <span class='kw'>deff</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
         <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># S3 method for svystatB</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/coef'>coef</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for svystatB</span>
<span class='fu'><a href='extractors.html'>SE</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for svystatB</span>
<span class='fu'><a href='extractors.html'>VAR</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for svystatB</span>
<span class='fu'><a href='extractors.html'>cv</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for svystatB</span>
<span class='fu'><a href='extractors.html'>deff</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for svystatB</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/confint'>confint</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for svystatB</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>design</th>
      <td><p>Object of class <code>analytic</code> (or inheriting from it) containing survey data and sampling design metadata.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>Formula specifying the linear model whose coefficients have to be estimated.</p></td>
    </tr>
    <tr>
      <th>vartype</th>
      <td><p><code>character</code> vector specifying the desired variability estimators. It is possible to choose
                one or more of: standard error (<code>'se'</code>, the default), coefficient of variation (<code>'cv'</code>),
                percent coefficient of variation (<code>'cvpct'</code>), or variance (<code>'var'</code>).</p></td>
    </tr>
    <tr>
      <th>conf.int</th>
      <td><p>Compute confidence intervals for the estimates? The default is
                 <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>conf.lev</th>
      <td><p>Probability specifying the desired confidence level: the default value is <code>0.95</code>.</p></td>
    </tr>
    <tr>
      <th>deff</th>
      <td><p>Should the design effect be computed? The default is <code>FALSE</code> (see &#8216;Details&#8217;).</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>Should missing values (if any) be removed from the variables of interest? The default is
              <code>FALSE</code> (see &#8216;Details&#8217;).</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>An object of class <code>svystatB</code>.</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>Additional arguments to <code>coef</code>, &#8230;, <code>confint</code> methods (if any).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function computes weighted estimates for Multiple Regression Coefficients using suitable weights depending on the class of <code>design</code>: calibrated weights for class <code>cal.analytic</code> and direct weights otherwise. Standard errors are calculated using the Taylor linearization technique.</p>
<p>The mandatory argument <code>model</code> identifies the regression model whose population coefficients have to be estimated (for details on model specification, see e.g. <code><a href='https://www.rdocumentation.org/packages/stats/topics/lm'>lm</a></code>). The <code>design</code> variables referenced by <code>model</code> should be <code>numeric</code> or <code>factor</code> (variables of other types - e.g. <code>character</code> - will be coerced).</p>
<p>The <code>conf.int</code> argument allows to request the confidence intervals for the estimates. By default <code>conf.int=FALSE</code>, that is the confidence intervals are not provided.</p>
<p>Whenever confidence intervals are requested (i.e. <code>conf.int=TRUE</code>), the desired confidence level can be specified by means of the <code>conf.lev</code> argument. The <code>conf.lev</code> value must represent a probability (<code>0&lt;=conf.lev&lt;=1</code>) and its default is chosen to be <code>0.95</code>.</p>
<p>The optional argument <code>deff</code> allows to request the design effect [Kish 1995] for the estimates. By default <code>deff=FALSE</code>, that is the design effect is not provided. The design effect of an estimator is defined as the ratio between the variance of the estimator under the actual sampling design and the variance that would be obtained for an 'equivalent' estimator under a hypothetical simple random sampling without replacement of the same size. To obtain an estimate of the design effect comparing to simple random sampling <em>"with replacement"</em>, one must use <code>deff="replace"</code>.<br />
For nonlinear estimators, the design effect is estimated on the linearized version of the estimator (that is for the estimator of the total of the linearized variable, aka "Woodruff transform").<br />
When dealing with domain estimation, the design effects referring to a given subpopulation are currently computed by taking the ratios between the actual variance estimates and those that would have been obtained if a simple random sampling were carried out <em>within</em> that subpopulation. This is the same as the <code>srssubpop</code> option for Stata's function <code>estat</code>.</p>
<p>Missing values (<code>NA</code>) in model variables should be avoided. If <code>na.rm=FALSE</code> (the default) they generate an error. If <code>na.rm=TRUE</code>, observations containing NAs in model variables are dropped, and estimates gets computed on non missing values only. This implicitly assumes that missing values hit interest variables <em>completely at random</em>: should this be not the case, computed estimates would be <em>biased</em>.</p>
<p>The <code>summary</code> method invoked on regression coefficients (say <code>b</code>) estimated via <code>svystatB</code>, gives p-values and significance codes for the component-wise test <code>b = 0</code>. Such values are computed assuming that the distribution of the regression coefficients estimators is normal (which is asymptotically true for large scale surveys). This assumption has the advantage of overcoming the problem of choosing the "right" statistic and assessing its "right" number of degrees of freedom when using data from a complex survey (see e.g. [Korn, Graubard 1990]).</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object inheriting from the <code>data.frame</code> class, whose detailed structure depends on input parameters' values.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Sarndal, C.E., Swensson, B., Wretman, J. (1992) <em>"Model Assisted Survey Sampling"</em>, Springer Verlag.</p>
<p>Kish, L. (1995). <em>"Methods for design effects"</em>. Journal of Official Statistics, Vol. 11, pp. 55-77.</p>
<p>Korn, E.L., Graubard, B.I. (1990) <em>"Simultaneous testing of regression coefficients with complex survey
data: Use of Bonferroni t statistics"</em>. The American Statistician, 44, 270-276.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Estimators of Totals and Means <code><a href='svystatTM.html'>svystatTM</a></code>, Ratios between Totals <code><a href='svystatR.html'>svystatR</a></code>, Shares <code><a href='svystatS.html'>svystatS</a></code>, Ratios between Shares <code><a href='svystatSR.html'>svystatSR</a></code>, Quantiles <code><a href='svystatQ.html'>svystatQ</a></code>, Complex Analytic Functions of Totals and/or Means <code><a href='svystatL.html'>svystatL</a></code>, and all of the above <code><a href='svystat.html'>svystat</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>######################################################</span>
<span class='co'># A simple regression model with a single predictor. #</span>
<span class='co'># Let's compare the estimated regression coefficient #</span>
<span class='co'># to its true value computed on the sampling frame.  #</span>
<span class='co'>######################################################</span>

<span class='co'># Load sbs data:</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>sbs</span>)

<span class='co'># Create a design object:</span>
<span class='no'>sbsdes</span><span class='kw'>&lt;-</span><span class='fu'><a href='e.svydesign.html'>e.svydesign</a></span>(<span class='kw'>data</span><span class='kw'>=</span><span class='no'>sbs</span>,<span class='kw'>ids</span><span class='kw'>=</span>~<span class='no'>id</span>,<span class='kw'>strata</span><span class='kw'>=</span>~<span class='no'>strata</span>,<span class='kw'>weights</span><span class='kw'>=</span>~<span class='no'>weight</span>,
        <span class='kw'>fpc</span><span class='kw'>=</span>~<span class='no'>fpc</span>)

<span class='co'># The population scatterplot of y vs emp.num reveals a linear</span>
<span class='co'># behaviour:</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/plot'>plot</a></span>(<span class='no'>sbs.frame</span>$<span class='no'>emp.num</span>,<span class='no'>sbs.frame</span>$<span class='no'>y</span>,
     <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/rgb'>rgb</a></span>(<span class='fl'>50</span>,<span class='fl'>205</span>,<span class='fl'>50</span>,<span class='fl'>100</span>,<span class='kw'>maxColorValue</span><span class='kw'>=</span><span class='fl'>255</span>),<span class='kw'>pch</span><span class='kw'>=</span><span class='fl'>16</span>)</div><div class='input'>
<span class='co'># Compute the population fit of the linear regression</span>
<span class='co'># model y~emp.num-1 (no intercept):</span>
<span class='no'>pop.fit</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/lm'>lm</a></span>(<span class='no'>y</span>~<span class='no'>emp.num</span>-<span class='fl'>1</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='no'>sbs.frame</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/abline'>abline</a></span>(<span class='no'>pop.fit</span>,<span class='kw'>col</span><span class='kw'>=</span><span class='st'>"red"</span>,<span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>2</span>,<span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>2</span>)</div><div class='img'><img src='svystatB-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># The obtained population R-squared is quite significant</span>
<span class='co'># (greater than 0.7):</span>
<span class='no'>pop.R2</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>pop.fit</span>)$<span class='no'>r.squared</span>
<span class='no'>pop.R2</span></div><div class='output co'>#&gt; [1] 0.7283881</div><div class='input'>
<span class='co'># The population regression coefficient is:</span>
<span class='no'>B</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/coef'>coef</a></span>(<span class='no'>pop.fit</span>)
<span class='no'>B</span></div><div class='output co'>#&gt;  emp.num 
#&gt; 17.53945 </div><div class='input'>
<span class='co'># Now let's estimate B on the basis of the sbs sample and</span>
<span class='co'># let's build a 95% confidence interval for the obtained estimate:</span>
<span class='fu'>svystatB</span>(<span class='no'>sbsdes</span>,<span class='no'>y</span>~<span class='no'>emp.num</span>-<span class='fl'>1</span>,<span class='kw'>conf.int</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;         RegCoef.y          SE CI.l(95%) CI.u(95%)
#&gt; emp.num  17.54959 0.009214501  17.53153  17.56765</div><div class='input'>
<span class='co'># Thus, the confidence interval covers the true value of B.</span>

<span class='co'># Notice that using ReGenesees Complex Estimators function</span>
<span class='co'># svystatL, you would have obtained exactly the same results:</span>
<span class='no'>sbsdes</span><span class='kw'>&lt;-</span><span class='fu'><a href='des.addvars.html'>des.addvars</a></span>(<span class='no'>sbsdes</span>,<span class='kw'>y4emp.num</span><span class='kw'>=</span><span class='no'>y</span>*<span class='no'>emp.num</span>,
                           <span class='kw'>emp.num.sq</span><span class='kw'>=</span><span class='no'>emp.num</span>^<span class='fl'>2</span>)
<span class='fu'><a href='svystatL.html'>svystatL</a></span>(<span class='no'>sbsdes</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/expression'>expression</a></span>(<span class='no'>y4emp.num</span>/<span class='no'>emp.num.sq</span>),
         <span class='kw'>conf.int</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;                       Complex          SE CI.l(95%) CI.u(95%)
#&gt; y4emp.num/emp.num.sq 17.54959 0.009214501  17.53153  17.56765</div><div class='input'>

<span class='co'>##################################</span>
<span class='co'># A multiple regression example. #</span>
<span class='co'>##################################</span>

<span class='co'># Let's estimate the coefficients of a model describing</span>
<span class='co'># value added (variable va.imp2) as a linear function</span>
<span class='co'># of number of employees by region and of nace.macro:</span>
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'>svystatB</span>(<span class='no'>sbsdes</span>,<span class='no'>va.imp2</span>~<span class='no'>emp.num</span>:<span class='no'>region</span>+<span class='no'>nace.macro</span>,<span class='kw'>vartype</span><span class='kw'>=</span><span class='st'>"cvpct"</span>)
<span class='no'>b</span></div><div class='output co'>#&gt;                      RegCoef.va.imp2          CV%
#&gt; (Intercept)               1561.91755    7.6425014
#&gt; nace.macroIndustry         415.93033   30.3670410
#&gt; nace.macroCommerce        3197.19585   10.0514767
#&gt; nace.macroServices        -115.03661 -109.6403342
#&gt; emp.num:regionNorth         15.84036    0.2018553
#&gt; emp.num:regionCenter        14.74595    0.5733876
#&gt; emp.num:regionSouth         22.26434    1.0550597</div><div class='input'>
<span class='co'># To obtain p-values and significance codes for the</span>
<span class='co'># component-wise test t=0, you can exploit the</span>
<span class='co'># summary method:</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>b</span>)</div><div class='output co'>#&gt;                      RegCoef.va.imp2        CV%  z value  Pr(&gt;|z|)    
#&gt; (Intercept)               1561.91755    7.64250  13.0847 &lt; 2.2e-16 ***
#&gt; nace.macroIndustry         415.93033   30.36704   3.2930 0.0009911 ***
#&gt; nace.macroCommerce        3197.19585   10.05148   9.9488 &lt; 2.2e-16 ***
#&gt; nace.macroServices        -115.03661 -109.64033  -0.9121 0.3617302    
#&gt; emp.num:regionNorth         15.84036    0.20186 495.4043 &lt; 2.2e-16 ***
#&gt; emp.num:regionCenter        14.74595    0.57339 174.4021 &lt; 2.2e-16 ***
#&gt; emp.num:regionSouth         22.26434    1.05506  94.7814 &lt; 2.2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; NOTE: the distribution of regression coefficients estimators has been assumed normal
#&gt; </div><div class='input'>
<span class='co'># Notice that estimators normality is assumed.</span>


<span class='co'>##########################################</span>
<span class='co'># Obtaining domain means via regression. #</span>
<span class='co'>##########################################</span>

<span class='co'># The domain mean of a numeric variable can be thought</span>
<span class='co'># as a regression coefficient. Suppose you need the</span>
<span class='co'># average number of employees by macro-sector, you can</span>
<span class='co'># do as follows:</span>
<span class='fu'>svystatB</span>(<span class='no'>sbsdes</span>,<span class='no'>emp.num</span>~<span class='no'>nace.macro</span>-<span class='fl'>1</span>)</div><div class='output co'>#&gt;                       RegCoef.emp.num        SE
#&gt; nace.macroAgriculture        37.20290 0.2081664
#&gt; nace.macroIndustry           62.55560 0.1202409
#&gt; nace.macroCommerce           22.61995 0.1969446
#&gt; nace.macroServices           70.46560 0.1401686</div><div class='input'>
<span class='co'># ...which, indeed, gives exactly the same results of:</span>
<span class='fu'><a href='svystatTM.html'>svystatTM</a></span>(<span class='no'>sbsdes</span>,<span class='kw'>y</span><span class='kw'>=</span>~<span class='no'>emp.num</span>,<span class='kw'>by</span><span class='kw'>=</span>~<span class='no'>nace.macro</span>,<span class='kw'>estimator</span><span class='kw'>=</span><span class='st'>"Mean"</span>)</div><div class='output co'>#&gt;              nace.macro Mean.emp.num SE.Mean.emp.num
#&gt; Agriculture Agriculture     37.20290       0.2081664
#&gt; Industry       Industry     62.55560       0.1202409
#&gt; Commerce       Commerce     22.61995       0.1969446
#&gt; Services       Services     70.46560       0.1401686</div><div class='input'>

<span class='co'>##########################</span>
<span class='co'># Handling collinearity. #</span>
<span class='co'>##########################</span>

<span class='co'># Function svystatB overcomes problems arising from exact</span>
<span class='co'># collinearity between model variables via 'aliasing'.</span>
<span class='co'># To understand how aliasing works, let's build a manifestly</span>
<span class='co'># redundant linear model:</span>
<span class='fu'>svystatB</span>(<span class='no'>sbsdes</span>,<span class='no'>y</span>~<span class='no'>emp.num</span>+<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/AsIs'>I</a></span>(<span class='fl'>2</span>*<span class='no'>emp.num</span>)+<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/AsIs'>I</a></span>(<span class='fl'>3</span>*<span class='no'>va.imp2</span>)+<span class='no'>va.imp2</span>-<span class='fl'>1</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Variables I(2 * emp.num), va.imp2 have been aliased due to collinearity!</span></div><div class='output co'>#&gt;                  RegCoef.y          SE
#&gt; emp.num        13.22362914 0.101697196
#&gt; I(3 * va.imp2)  0.08026756 0.001999472</div><div class='input'>
<span class='co'># The obtained warning message shows that order definitely matters</span>
<span class='co'># in aliasing, indeed:</span>
<span class='fu'>svystatB</span>(<span class='no'>sbsdes</span>,<span class='no'>y</span>~<span class='no'>emp.num</span>+<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/AsIs'>I</a></span>(<span class='fl'>2</span>*<span class='no'>emp.num</span>)+<span class='no'>va.imp2</span>+<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/AsIs'>I</a></span>(<span class='fl'>3</span>*<span class='no'>va.imp2</span>)-<span class='fl'>1</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Variables I(2 * emp.num), I(3 * va.imp2) have been aliased due to collinearity!</span></div><div class='output co'>#&gt;          RegCoef.y          SE
#&gt; emp.num 13.2236291 0.101697196
#&gt; va.imp2  0.2408027 0.005998415</div><div class='input'>
<span class='co'># Notice also that aliasing gives exact estimates and standard errors</span>
<span class='co'># for non-aliased regression coefficients (i.e. the same results that</span>
<span class='co'># would be obtained with a reduced - no collinearity - model):</span>
<span class='fu'>svystatB</span>(<span class='no'>sbsdes</span>,<span class='no'>y</span>~<span class='no'>emp.num</span>+<span class='no'>va.imp2</span>-<span class='fl'>1</span>)</div><div class='output co'>#&gt;          RegCoef.y          SE
#&gt; emp.num 13.2236291 0.101697196
#&gt; va.imp2  0.2408027 0.005998415</div><div class='input'>

<span class='co'>###############################################</span>
<span class='co'># Handling missing values in model variables. #</span>
<span class='co'>###############################################</span>

<span class='co'># Load fpcdat:</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>fpcdat</span>)

<span class='co'># Now, let's introduce some NAs in survey data:</span>
<span class='no'>fpcdat</span>$<span class='no'>y</span>[<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>3</span>)]<span class='kw'>&lt;-</span><span class='fl'>NA</span>
<span class='no'>fpcdat</span>$<span class='no'>x</span>[<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>3</span>,<span class='fl'>5</span>)]<span class='kw'>&lt;-</span><span class='fl'>NA</span>

<span class='co'># Create a design object:</span>
<span class='no'>fpcdes</span><span class='kw'>&lt;-</span><span class='fu'><a href='e.svydesign.html'>e.svydesign</a></span>(<span class='kw'>data</span><span class='kw'>=</span><span class='no'>fpcdat</span>,<span class='kw'>ids</span><span class='kw'>=</span>~<span class='no'>psu</span>+<span class='no'>ssu</span>,<span class='kw'>strata</span><span class='kw'>=</span>~<span class='no'>stratum</span>,<span class='kw'>weights</span><span class='kw'>=</span>~<span class='no'>w</span>,
        <span class='kw'>fpc</span><span class='kw'>=</span>~<span class='no'>fpc1</span>+<span class='no'>fpc2</span>)

<span class='co'># Let's estimate regression coefficients of model z~y+x</span>
  <span class='co'># na.rm=FALSE (the default) leads to an error:</span></div><span class='co'># NOT RUN {</span>
  <span class='fu'>svystatB</span>(<span class='no'>fpcdes</span>,<span class='no'>z</span>~<span class='no'>y</span>+<span class='no'>x</span>)

<span class='co'># }</span><div class='input'>
  <span class='co'># whereas na.rm=TRUE simply drops all the cases</span>
  <span class='co'># with missing data in model variables:  </span>
  <span class='fu'>svystatB</span>(<span class='no'>fpcdes</span>,<span class='no'>z</span>~<span class='no'>y</span>+<span class='no'>x</span>,<span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Missing values in: y, x; corresponding observations (3) will be ignored!</span></div><div class='output co'>#&gt;               RegCoef.z        SE
#&gt; (Intercept) 106.1338699 6.2859923
#&gt; y             0.2839079 0.9679509
#&gt; x            -1.6402421 1.0672825</div><div class='input'>

<span class='co'>##################################</span>
<span class='co'># Handling non positive weights. #</span>
<span class='co'>##################################</span>

<span class='co'># Non positive direct weights are not allowed, anyway some</span>
<span class='co'># calibrated weights can sometimes turn out to be &lt;= 0. The</span>
<span class='co'># corrisponding observations would be dropped by svystatB.</span>

  <span class='co'># Prepare a template for population totals:</span>
  <span class='no'>pop</span><span class='kw'>&lt;-</span><span class='fu'><a href='pop.template.html'>pop.template</a></span>(<span class='no'>fpcdes</span>,~<span class='no'>z</span>+<span class='no'>pl.domain</span>-<span class='fl'>1</span>)

  <span class='co'># Fill it with silly values in order to obtain some negative g-weights:</span>
  <span class='no'>pop</span>[<span class='fl'>1</span>,]<span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>20000</span>,<span class='fl'>90</span>,<span class='fl'>10</span>,<span class='fl'>90</span>)

  <span class='co'># Calibrate:</span>
  <span class='no'>fpccal</span><span class='kw'>&lt;-</span><span class='fu'><a href='e.calibrate.html'>e.calibrate</a></span>(<span class='no'>fpcdes</span>,<span class='no'>pop</span>)

  <span class='co'># We got 2 negative calibrated weights:</span>
  <span class='fu'><a href='g.range.html'>g.range</a></span>(<span class='no'>fpccal</span>)</div><div class='output co'>#&gt;       g.min       g.max 
#&gt; -0.05392021  1.92609506 </div><div class='input'>  <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sum'>sum</a></span>(<span class='fu'><a href='weights.html'>weights</a></span>(<span class='no'>fpccal</span>)<span class='kw'>&lt;=</span><span class='fl'>0</span>)</div><div class='output co'>#&gt; [1] 2</div><div class='input'>
  <span class='co'># Now, let's estimate regression coefficients of model z~y+x</span>
  <span class='co'># and pay attantion to the warnings:</span>
  <span class='fu'>svystatB</span>(<span class='no'>fpccal</span>,<span class='no'>z</span>~<span class='no'>y</span>+<span class='no'>x</span>,<span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Detected 2 observations with weight &lt;= 0: they will be ignored!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Missing values in: y, x; corresponding observations (3) will be ignored!</span></div><div class='output co'>#&gt;             RegCoef.z        SE
#&gt; (Intercept)  104.5892 5.9801452
#&gt; y              1.8030 1.2176491
#&gt; x             -1.5671 0.8975358</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Diego Zardetto</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Diego Zardetto.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

